# 📊 시트매매

구글 시트에서 로직을 구성하고 매매 내역을 생성하면, Astra에서 해당 주문을 읽어서 실행하는 방식입니다.
Astra 에서는 시트 포맷만 제공하고 실제 매매법을 담은 시트는 제공하지 않습니다.
직접 제작하거나 [미국주식 퀀트투자 카페](https://cafe.naver.com/songspread)를 통해서 구하시면 됩니다.

## 1. 구글 시트 생성
구글 드라이브 사이트에서 구글 시트를 새로 생성합니다.
![sheet1](images/sheet1.png)

![sheet2](images/sheet2.png)

## 2. 시트 아이디 복사
새로 생성된 시트에서 아래 그림처럼 시트 URL을 복사한 후 Astra 프로그램의 구글시트 항목에 입력합니다.

![sheet3](images/sheet3.png)

## 3. 편집 권한 부여
구글 시트에서 오른쪽 상단의 Share 버튼을 클릭한 후, Astra 계정에 편집 권한을 부여합니다. Astra 계정은 astra-sheet@astra-sheet.iam.gserviceaccount.com 입니다. 진행하면서 시트 제목이 없다고 경고가 뜰 수도 있는데, 무시해도 되고 이름을 입력해도 됩니다.

![sheet4](images/sheet4.png)

## 4. 시트 생성
Astra 프로그램 설정 영역에 시트이름과 종목을 설정한 후 설정 저장 버튼을 클릭합니다. 잠시 기다리면 아래처럼 항목이 추가가 됩니다. 하늘색 셀을 수정해서 원하는 주문을 입력합니다.

![sheet5](images/sheet5.avif)

## 5. 주문 시작
주문 시작 버튼을 누르면 주문이 시작됩니다.

다음과 같은 순서로 진행이 됩니다.

1. HTS 실행
2. 전일 종가, 현재가, 보유수량, 주문가능금액 확인
3. 주문 넣기 
4. 주문 내역 텔레그램 메시지 전송